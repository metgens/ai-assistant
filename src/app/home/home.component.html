<div class="main-container flex-fill">
  <h1 class="title">
    Assistant
  </h1>

  <div class="flex flex-col w-100 p-3 pt-0" style="margin-top: -20px;">
    <div class="collapse" id="collapseExample">
      <div class="input-group w-100 py-1">
        <input class="form-control" placeholder="OpenAI API Key" type="text" (blur)="updateApiKey($event)"
          [value]="currentState?.apiKey">
      </div>
    </div>


    <div class="input-group w-100 py-1">
      <textarea class="form-control" aria-label="With textarea" (change)="updateQuery($event)"
        [value]="currentState?.query" placeholder="Ask me anything..." name="prompt" id="" rows="4"></textarea>
    </div>
    <div class="d-flex flex-row w-100">
      <button class="btn btn-primary w-25 my-2 me-auto" (click)="ask()">
        Send
      </button>
      <button class="btn btn-dark" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample"
        aria-expanded="false" aria-controls="collapseExample">
        API Key
      </button>
    </div>
  </div>

  <div class="w-100 p-3">
    <div *ngFor="let message of currentState?.messages" class="w-100">
      <pre style="white-space: break-spaces;">
      <span *ngIf="message.role === 'system'" class="">system ({{currentState?.model}}): {{message.content}}</span>
      <div *ngIf="message.role !== 'system'" class="font-bold">{{message.role === 'assistant' ? 'Angela' : 'You'}}:{{message.content}}</div>
    </pre>
    </div>
  </div>
</div>